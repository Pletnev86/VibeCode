# Система сессионного логирования VibeCode

## Обзор

VibeCode использует двухуровневую систему логирования:
1. **Сессионные логи** - логи текущей сессии, отображаются в интерфейсе
2. **Общий лог** - все сессии сохраняются в файл для анализа проблем

## Как это работает

### При запуске приложения:
- Создается новая сессия с уникальным ID
- Логи интерфейса очищаются (показывается "[Новая сессия]")
- Все логи текущей сессии сохраняются в памяти

### Во время работы:
- Все логи записываются в:
  - **Сессионные логи** (в памяти) - отображаются в интерфейсе
  - **Общий лог файл** (`logs/system/vibecode-general.log`) - для анализа проблем

### При закрытии приложения:
- Сессионные логи автоматически сохраняются в общий лог файл
- Каждая сессия сохраняется с заголовком и метаданными:
  - ID сессии
  - Время начала и окончания
  - Длительность сессии
  - Количество логов

## Файлы логов

### Сессионные логи (интерфейс)
- **Расположение:** В памяти приложения
- **Отображение:** Панель логов в интерфейсе
- **Содержимое:** Только логи текущей сессии
- **Очистка:** При каждом запуске приложения

### Общий лог (анализ проблем)
- **Расположение:** `logs/system/vibecode-general.log`
- **Содержимое:** Все сессии с момента установки
- **Формат:** JSON строки, каждая сессия имеет заголовок и завершение
- **Использование:** Для анализа проблем и истории работы

## Анализ проблем

При анализе проблем с VibeCode нужно смотреть **оба лога**:

1. **Логи текущей сессии** (в интерфейсе):
   - Показывают что происходит прямо сейчас
   - Очищаются при каждом запуске
   - Полезны для отладки текущей проблемы

2. **Общий лог файл** (`logs/system/vibecode-general.log`):
   - Содержит историю всех сессий
   - Позволяет найти паттерны и повторяющиеся проблемы
   - Полезен для анализа долгосрочных проблем

### Как получить общий лог:

**Через код:**
```javascript
const result = await window.api.getGeneralLogs(1000); // Последние 1000 записей
console.log(result.logs);
console.log('Файл:', result.filePath);
```

**Через файловую систему:**
```
C:\CursorX\logs\system\vibecode-general.log
```

## Структура сессии в общем логе

Каждая сессия в общем логе имеет структуру:

```json
{
  "timestamp": "2025-12-08T00:53:24.178Z",
  "type": "session",
  "sessionId": "2025-12-08T00-53-24",
  "sessionStart": "2025-12-08T00:53:24.178Z",
  "sessionEnd": "2025-12-08T01:15:30.245Z",
  "duration": "1322.07 сек",
  "logCount": 156,
  "message": "=== Сессия 2025-12-08T00-53-24 ==="
}
```

Затем идут все логи сессии, и в конце:

```json
{
  "timestamp": "2025-12-08T01:15:30.245Z",
  "type": "session",
  "sessionId": "2025-12-08T00-53-24",
  "message": "=== Конец сессии 2025-12-08T00-53-24 ==="
}
```

## Преимущества

1. **Чистый интерфейс** - показываются только логи текущей сессии
2. **Полная история** - все сессии сохраняются для анализа
3. **Легкий анализ** - каждая сессия четко разделена
4. **Автоматическое сохранение** - не нужно вручную сохранять логи

## Технические детали

- **Модуль:** `lib/session-logger.js`
- **Интеграция:** Автоматически перехватывает логи из основного logger
- **Формат:** JSON строки (по одной на строку)
- **Кодировка:** UTF-8
- **Ротация:** Не требуется (файл растет, но можно очистить вручную)

